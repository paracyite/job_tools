#!/bin/bash
set -euo pipefail

CONFIG_DIR="${XDG_CONFIG_HOME:-$HOME/.config}/job_tools"
source "$CONFIG_DIR/configuration.txt"
source "$CONFIG_DIR/data.txt"

DEST="$HOME/Documents/JOB_APPLICATIONS"
ROLE_LOWER=$(echo "$APPLIED_ROLE" | tr '[:upper:]' '[:lower:]' | tr -s ' ' '_')
FILE="$DEST/${NAME_FIRST}_${NAME_LAST}_${ROLE_LOWER}_Cover_Letter.md"

TODAY=$(date "+%B %d, %Y")
HM="${HIRING_MANAGER:-Hiring Manager}"

cat > "$FILE" << EOF

${NAME_FIRST} ${NAME_LAST}

${ADDRESS}
${CITY}, ${STATE}

${PHONE}|${EMAIL}

$TODAY

$COMPANY
$COMPANY_ADDRESS
$COMPANY_CITY, $COMPANY_STATE

Dear $HM,

I am writing to express my strong interest in the $APPLIED_ROLE position at $COMPANY.

With experience as Package Handler at FedEx Ground, Record Clerk at KDI Office Technologies, and Welder at Alessandra Misc Metalworks, I bring a proven mix of logistics, technical, and fabrication skills.

Key strengths I offer:

- $BULLET_ONE
- $BULLET_TWO
- $BULLET_THREE
- $BULLET_FOUR

I’m particularly excited about this role because $COMPANY_FACT.

I would welcome the opportunity to discuss how I can contribute to your team.

Sincerely,

${NAME_FIRST} ${NAME_LAST}
EOF

echo "Cover letter ready — $(basename "$FILE")"
