#!/usr/bin/env bash
set -euo pipefail

CONFIG_FILE="${XDG_CONFIG_HOME:-$HOME/.config}/job_tools/configuration.txt"
DATA_FILE="${XDG_CONFIG_HOME:-$HOME/.config}/job_tools/data.txt"
"${EDITOR:-nvim}" "$DATA_FILE"

echo "Generating resume + cover letter..."
source "${XDG_CONFIG_HOME:-$HOME/.config}/job_tools/configuration.txt"
source "$DATA_FILE"

~/Bash/job_tools/resumeWrite && echo "Resume: OK"
~/Bash/job_tools/CoverGen    && echo "Cover Letter: OK"
~/Bash/job_tools/to-pdf      && echo "PDFs: OK"

echo "DONE â€” Your perfectly tailored application is ready:"
ls -1tr ~/Documents/JOB_APPLICATIONS/${NAME_FIRST}_${NAME_LAST}_*_*.pdf 2>/dev/null | tail -2 | sed 's/^/   /'
